### 预备知识

* 剩余系:指对于某一个特定的正整数ｎ，一个整数集中的数mod n所得的余数域。

* 完全剩余系:$设m∈Z+，若r_0,r_1,...r_{m-1}为m个整数，并且两两模m不同余，则r_0,r_1,...r_{m-1}叫作模m的一个完全剩余系。$

* 缩系:设A是mod n的剩余系，若任意A中两个元素相乘mod n后仍为A中的元素,则称A为mod n的缩系

好吧其实后面好像用不上，但总还是有用的。

### 欧拉函数

* 定义

$\phi(n)$为不超过n且与n互质的数的个数。

显然，若p为质数，$\phi(p)=p-1$

$\phi(p^k)=p^k-p^{k-1}$　因为与$p^k$不互质的只有p的倍数，而p的倍数有$P^{k-1}$个。

**欧拉函数是积性函数。**

证明:（需要中国剩余定理）

$n=p_1^{k_1}p_2^{k_2}...p_m^{k_m}$

若x,n互质，则x%n,$p_1^{k_1}也互质$

$$\begin{cases}
x \equiv　a_1　mod　p_1^{k_1}\\
x \equiv　a_2　mod　p_2^{k_2}\\
...\\
x \equiv　a_m　mod　p_m^{k_m}\\
\end{cases}
$$

$x,a_i,p_i^{k_1}均互质$

在一组方程中，$a_i$ 有多种取法，需满足gcd($a_1,p_1^{k_1})=1$

$\therefore$　$\phi(p_i^{k_i})$=sizeof{$a_i$}

根据中国剩余定理，在１～ｎ范围内有唯一ｘ，又gcd(x,n)=1

则x有$\phi(n)$中取法

对于每一个ｘ，与{$a_1,a_2,...,a_m$}集合唯一对应

有$N_{a_1}*N_{a_2}*...*N_{a_m}$种方法

=$\phi(p_1^{k_1})*\phi(p_2^{k_2})*...*\phi(p_m^{k_m})$

分别对应一个唯一的ｘ

$\therefore$　 $\phi(p_1^{k_1})*\phi(p_2^{k_2})*...*\phi(p_m^{k_m})=\phi(n)$

又 $n=p_1^{k_1}p_2^{k_2}...p_m^{k_m}$

$\therefore$　$\phi$为积性函数

---

# 若gcd(a,M)=1,则$a^{\phi(M)} \equiv　1　(mod　M)$

**证明:**

设a,M互质,有M的一个缩系为{$a,2a,...,\phi(M)a$},缩系元素个数为$\phi(M)$个

$$\phi(M)!　\equiv　\prod^{\phi(M)}{a_i}　(mod　M) $$

$$\phi(M)!　\equiv　a^{\phi(M)}\phi(M)!　(mod　M) $$

$$a^{\phi(M)} \equiv　1　(mod　M)$$

**当M为质数时，则有$\phi(M)=M-1$,即费马小定理**

---

ok,继续之前的内容

当n=$p_1^{a_1}p_2^{a_2}...p_k^{a_k}$时

$$\phi(n)=\prod_{i=1}^{k}{p_i^{a_i-1}(p_i-1)}=n*\prod_{i=1}^k{(1-\frac{1}{p_i})}=n*\prod_{i=1}^k{\frac{p_i-1}{p_i}}$$
可以用此式子递推

# <center>[欧拉函数递推公式证明](https://www.wandouip.com/t5i88841/)(转载)</center>

欧拉函数phi(n)表示的是1到n当中与n互质的数的个数。

假设n=m*p，（p为n的随机1个质因子）

当m%p=0时，phi(n)=phi(m)*p

当m%p!=0时，phi(n)=phi(m)*(p-1)

根据质因数分解定理，n至少可以分解出一个素数p，使得n = p*m。

我们可以将1到n的这个范围划分为一个区间的集合{[m*(i-1),m*i],1<=i<=p}，则对于每个区间[m*(i-1)+1,m*i ]，其中的每个数可以看成是m*(i-1)+j(1<=j<=m)。

根据辗转相除法，可以得出gcd(m*(i-1)+j,m)=gcd(m,(m*(i-1)+j)%m)=gcd(m,j)

从上面的结论，我们可以看出，每个区间对应的某个数对m取模均与0到m-1中的某个数相同，所以1到n当中与m互质的数有p*phi(m)个。

如果m%p=0，假设m=k*p（k为一个正整数），gcd(b,m)=1，由于p是m的一个因子，如果b和m不存在公共因子的话，那么b和p也肯定不存在公共因子，因此可以得出gcd(b,p)=1，两者组合起来可得：gcd(m*p,b)=gcd(n,b)=1，所以在这种情况下，1到n范围内与m互质的数均与n互质，所以便可得出phi(n) = phi(m)*p;

如果m%p!=0，我们从gcd(b,m)=1的这个条件当中不能够得到gcd(b,p)=1的这个条件，由于p是素数，p的因子只有两个：1和p，所以gcd(b,p)也就只有两个可能出现的值：1或p，假设存在gcd(b,m)=1，gcd(b,p)=p的这样一种情况，由于m%p!=0，表明m的因子当中不含有p，所以gcd(n,b)=p。在1到n当中，满足gcd(b,m)=1和gcd(b,p)=p这两个条件的数，只能是与m互质并且是p的倍数的数，因此便有phi(m)个数满足这两个条件，所以phi(n)=phi(m)*p-phi(m)=phi(m)*(p-1)。

---
扩展欧拉定理

如果gcd(a,M)!=1,那么$a^b \equiv a^{b　mod　\phi(M)+\phi(M)}　(mod　M)(b>\phi(M))$

