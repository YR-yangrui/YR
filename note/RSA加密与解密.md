# RSA加密与解密

这里只是讲讲$RSA$是怎么加密以及怎么解密。

## 加密与解密过程

采用$RSA$的方法后可以得到一个公钥$(n,e)$和私钥$(n,d)$。

对于一个明文$a$,我们把它加密得到$b$,$b=a^e~~mod~~n$。我们把$b$,发给接收者，接收者把$b$解密:$a=b^{d}~~mod~~n$即可查看密文了。

那么$RSA$是怎么做的呢？

首先我们任意选取两个质数$p,q$,令$n=pq$，然后求出$n$的欧拉函数$r=\phi(n)$。任选一个小于$r$且与$r$互质的数$d$,求出$d$在模$r$意义下的逆元$e$,然后组成公钥$(n,e)$和私钥$n,d$，最后销毁$p,q$即可。

我们可以根据之前的方法解密:$b^{d}=a^{ed}=a$可知此方法是正确的。

## 安全性

在攻击者已知$n$和$e$,如果他能求出$\phi(n)$来，那么即可获得私钥$(n,d)$了。又由于$\phi(n)=(p-1)(q-1)$，而$p,q$对于攻击者是不可知的，那么他只能够去分解$n$，那么只要$p,q$足够大，耗费的时间就会是不可承受的。



---

我们看一道题来加深印象。

**(CCPC-Final 2018)K - Mr. Panda and Kakin**

题意:$x$是[1e5,1e9]​的随机数,$p$是小于$x$的最大素数,$q$是大于等于x的最小素数,$n=p,c=f ^{2^{30}+3}~~~mod~~n$,给$n$和$c$求$f$。



**题解**

这个题就是一个裸的$RSA$解密。我们在$\sqrt{n}$附近找到$p,q$,求出$\phi(n)$,令$e=2^{30+3}$,$d=e^{-1}~~mod~~\phi(n)$。那么$c=f^e ~~ mod~~n$,就是所谓的密文了，$f$即为$c^{d}~~mod~~n$。

